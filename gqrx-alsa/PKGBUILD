# Maintainer: Kyle Keen <keenerd@gmail.com>
# Contributor: Dominik Heidler <dheidler@gmail.com>

pkgname=gqrx
pkgver=2.14.4
pkgrel=0
pkgdesc=" Software defined radio receiver powered by GNU Radio and Qt"
arch=('x86_64')
url="https://gqrx.dk"
license=('GPL')
depends=('qt5-svg' 'libpulse' 'gnuradio-osmosdr' 'libxkbcommon-x11')
makedepends=('boost')
source=("$pkgname-$pkgver.tgz::https://github.com/csete/gqrx/archive/v$pkgver.tar.gz")
md5sums=('f8ff8e564fff8f930ae27c291ed20839')

prepare() {
  cd "${srcdir}/${pkgname}-${pkgver}"

  sed -i 's/\(set(LINUX_AUDIO_BACKEND\) Pulseaudio/\1 Gr-audio/g' CMakeLists.txt
}

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"

  cmake .
  make
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"

  install -d -m755 "$pkgdir"/usr/{bin,share/applications,share/pixmaps}

  install -D -m644 gqrx.desktop "$pkgdir"/usr/share/applications
  install -D -m644 resources/icons/gqrx.svg "$pkgdir"/usr/share/pixmaps
  install -D -m755 src/gqrx "$pkgdir"/usr/bin
}
